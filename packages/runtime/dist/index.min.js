(function(c,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(c=typeof globalThis<"u"?globalThis:c||self,p(c["@smoljs/runtime"]={}))})(this,function(c){"use strict";function p(e,t,n,r=null){const s=(...o)=>{r?t.apply(r,o):t(...o)};return n.addEventListener(e,s),s}function Z(e={},t,n=null){const r={};return Object.entries(e).forEach(([s,o])=>{const i=p(s,o,t,n);r[s]=i}),r}function G(e,t){Object.entries(e).forEach(([n,r])=>{t.removeEventListener(n,r)})}function J(e){return e.filter(t=>t!=null)}function Q(e,t){return{added:t.filter(n=>!e.includes(n)),removed:e.filter(n=>!t.includes(n))}}const a={ADD:"add",REMOVE:"remove",MOVE:"move",NOOP:"noop"};class X{#e;#t;#n;constructor(t,n){this.#e=[...t],this.#t=t.map((r,s)=>s),this.#n=n}get length(){return this.#e.length}isRemovedFromArray(t,n){if(t>=this.length)return!1;const r=this.#n,s=this.#e;return!n.some(o=>r(s[t],o))}isUnchangedItem(t,n){return t>=this.length?!1:this.#n(this.#e[t],n[t])}removeItem(t){const[n]=this.#e.splice(t,1),[r]=this.#t.splice(t,1);return{op:a.REMOVE,index:t,item:n,originalIndex:r}}addItem(t,n){return this.#e.splice(n,0,t),this.#t.splice(n,0,-1),{op:a.ADD,index:n,item:t}}moveItem(t,n){const r=this.#e.findIndex(i=>this.#n(i,t));if(r===-1)throw new Error("Item not found");const[s]=this.#e.splice(r,1),[o]=this.#t.splice(r,1);return this.#e.splice(n,0,s),this.#t.splice(n,0,o),{op:a.MOVE,from:r,index:n,item:s,originalIndex:o}}removeRemainingItems(t){const n=[];for(;this.length>t;)n.push(this.removeItem(t));return n}findItemIndex(t,n){const r=this.length,s=this.#n,o=this.#e;if(n<0||n>=r)return-1;for(let i=n;i<r;i++)if(s(t,o[i]))return i;return-1}noopItem(t){return{op:a.NOOP,index:t,item:this.#e[t],originalIndex:this.#t[t]}}}function Y(e,t,n=(r,s)=>r===s){const r=[],s=new X(e,n);for(let o=0;o<t.length;o++){const i=t[o];if(s.isRemovedFromArray(o,t)){r.push(s.removeItem(o)),o--;continue}if(s.isUnchangedItem(o,t)){r.push(s.noopItem(o));continue}if(s.findItemIndex(i,o)===-1){r.push(s.addItem(i,o));continue}r.push(s.moveItem(i,o))}return r.push(...s.removeRemainingItems(t.length)),r}function v(){}function D(e,t){if(e.type!==t.type)return!1;const{type:n,props:{key:r}}=e,{type:s,props:{key:o}}=t;return n===s&&r===o}function S(e={},t={}){const n=Object.keys(e),r=Object.keys(t);return{added:r.filter(s=>!(s in e)),removed:n.filter(s=>!(s in t)),updated:r.filter(s=>s in e&&e[s]!==t[s])}}function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const tt=Function.call.bind(Object.prototype.isPrototypeOf);function g(e){if(!e.children||N(e))return[];const t=[];for(const n of e.children)y(n)?t.push(...g(n)):t.push(n);return t}function V(e){return e.trim()!==""}function L(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function et(e,t){const{class:n,style:r,...s}=t;n&&nt(e,n),r&&Object.entries(r).forEach(([o,i])=>{M(e,o,i)});for(const[o,i]of Object.entries(s))R(e,o,i)}function nt(e,t){e.className="",typeof t=="string"?e.className=t:Array.isArray(t)&&e.classList.add(...t.filter(V))}function M(e,t,n){e.style.setProperty(L(t),n)}function rt(e,t){e.style.removeProperty(L(t))}function R(e,t,n){n==null?q(e,t):t.startsWith("data-")?e.setAttribute(t,n):e[t]=n}function q(e,t){e[t]=null,e.removeAttribute(t)}function h(e,t,n,r){if(C(e))ut(e,t,n);else if(N(e))st(e,t,n);else if(y(e))ct(e,t,n,r);else if(O(e))ot(e,t,n,r);else throw new Error(`Cannot mount unknown VNode type: ${e.type}`)}function st(e,t,n){const{props:r}=e,s=document.createTextNode(r.nodeValue);e.el=s,$(s,t,n)}function ot(e,t,n,r){const{type:s,children:o}=e,i=document.createElement(s);e.el=i,it(i,e,r),o.forEach(u=>{h(u,i,null,r)}),$(i,t,n)}function it(e,t,n){const{on:r={},...s}=t.props,{key:o,...i}=s;t.listeners=Z(r,e,n),et(e,i)}function ct(e,t,n,r){const{children:s}=e;e.el=t,s.forEach((o,i)=>{h(o,t,n?n+i:null,r)})}function ut(e,t,n){const r=e.type,s=e.props,o=new r(s,e.children);o.mount(t,n),e.component=o,e.el=o.firstElement}function $(e,t,n){if(n==null){t.append(e);return}if(n<0)throw new Error(`Index must be a non-negative integer, got ${n}`);const r=t.childNodes;n>=r.length?t.append(e):t.insertBefore(e,r[n])}function ft(e,t,n){const{added:r,removed:s,updated:o}=S(t,n);s.forEach(i=>q(e,i)),[...r,...o].forEach(i=>R(e,i,n[i]))}function lt(e,t,n){const r=U(t),s=U(n),o=[...new Set([...e.classList,...r])],{added:i,removed:u}=Q(o,s);e.classList.remove(...u),e.classList.add(...i)}function U(e=""){return Array.isArray(e)?e.filter(V):e.split(/\s+/).filter(V)}function at(e,t={},n={},r={},s){const{added:o,removed:i,updated:u}=S(n,r);[...i,...u].forEach(f=>e.removeEventListener(f,t[f]));const l={};return[...o,...u].forEach(f=>{l[f]=p(f,r[f],e,s)}),l}function pt(e,t,n){const{added:r,removed:s,updated:o}=S(t,n);s.forEach(i=>rt(e,i)),[...r,...o].forEach(i=>M(e,i,n[i]))}function I(e,t,n,r){if(!D(e,t)){const s=Array.from(n.childNodes).indexOf(e.el);return E(e),h(t,n,s,r),t}return t.el=e.el,N(t)?(ht(e,t),t):C(t)?(mt(e,t),t):(O(t)&&dt(e,t,r),yt(e,t,r),t)}function ht(e,t){const{el:n}=e,{nodeValue:r}=e.props,{nodeValue:s}=t.props;r!==s&&(n.nodeValue=s)}function dt(e,t,n){const r=e.el,{class:s,style:o,on:i,...u}=e.props,{class:l,style:f,on:w,...F}=t.props;ft(r,u,F),lt(r,s,l),pt(r,o,f),t.listeners=at(r,e.listeners,i,w,n)}function mt(e,t){const{component:n}=e,{key:r,...s}=t.props;n.updateProps(s),t.component=n,t.el=n.firstElement}function yt(e,t,n){const r=g(e),s=g(t),o=e.el;Y(r,s,D).forEach(({op:u,index:l,originalIndex:f,item:w})=>{const F=n?.offset??0;switch(u){case a.ADD:h(w,o,l+F,n);break;case a.REMOVE:E(w);break;case a.MOVE:{const Vt=o.childNodes[l+F];o.insertBefore(r[f].el,Vt),I(r[f],s[l],o,n);break}case a.NOOP:I(r[f],s[l],o,n);break}})}function Et(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P,B;function gt(){return B||(B=1,P=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,s,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[s]))return!1;for(s=r;s--!==0;){var i=o[s];if(!e(t[i],n[i]))return!1}return!0}return t!==t&&n!==n}),P}var Nt=gt();const _=Et(Nt);class T{#e=!1;#t=null;#n=null;state;props;children;#r={};constructor(t,n){this.props=t??{},this.children=n??[]}get $refs(){return this.#r}get elements(){return this.#t?y(this.#t)?this.#u():[this.#t.el]:[]}get firstElement(){return this.elements[0]??null}get offset(){return y(this.#t)?Array.from(this.#n.childNodes).indexOf(this.firstElement):0}updateProps(t){const n={...this.props,...t};_(this.props,n)||(this.props=n,this.#s())}updateState(t){const n=typeof t=="function"?t(this.state):{...this.state,...t};_(this.state,n)||(this.state=n,this.#s())}mount(t,n=null){if(this.#e)throw new Error("Component is already mounted");this.#t=this.render(),h(this.#t,t,n,this),this.#i(),this.#n=t,this.#e=!0,this.onMounted()}unmount(){if(!this.#e)throw new Error("Component is not mounted");this.#r={},E(this.#t),this.#t=null,this.#n=null,this.#e=!1,this.onUnmounted()}#s(){if(!this.#e)throw new Error("Component is not mounted");const t=this.render();this.#t=I(this.#t,t,this.#n,this),this.onUpdated()}#i(){this.#o(this.#t),this.children.forEach(t=>{t.ref&&this.#o(t)})}#o(t){O(t)&&t.ref&&this.#c(t.ref,t.el)}#c(t,n){if(this.#r[t]){console.warn(`Ref "${t}" already exists`);return}this.#r[t]=n}#u(){return g(this.#t).flatMap(t=>A(t.type)?t.component.elements:t.el)}}function Ot({render:e,state:t,methods:n,onMounted:r=v,onUnmounted:s=v,onUpdated:o=v}){class i extends T{constructor(l,f){super(l,f),this.state=t?t(l):{}}render(){return e.call(this,this.props,{children:this.children})}onMounted(){return Promise.resolve(r.call(this))}onUnmounted(){return Promise.resolve(s.call(this))}onUpdated(){return Promise.resolve(o.call(this))}}for(const u in n){if(x(i,u)||u in i.prototype)throw new Error(`Method "${u}()" already exists in the component. Can't override`);i.prototype[u]=n[u]}return i}function Ct(e){return e.map(t=>d(t)?t:z(String(t)))}function At(e){return Array.isArray(e)||(e=[e]),Ct(J(e))}const b=Symbol.for("text"),j=Symbol.for("fragment");function m(e,t,n){const{ref:r,...s}=t??{},o=At(n||[]);return{_isVNode:!0,type:e,props:s,children:o,ref:typeof r=="string"?r:null,el:null,listeners:null,component:null}}function z(e){return m(b,{nodeValue:e})}function K(e){return m(j,null,e)}function d(e){return e?e?._isVNode===!0:!1}function N(e){return d(e)&&e.type===b}function y(e){return d(e)&&e.type===j}function O(e){return d(e)&&typeof e.type=="string"}function C(e){return d(e)&&A(e.type)}function A(e){return k(e)&&tt(T,e)}function k(e){return typeof e=="function"}function E(e){C(e)?wt(e):Ft(e)}function wt(e){e.component?.unmount()}function Ft(e){const{el:t,children:n,listeners:r}=e;r&&(t instanceof Element&&G(r,t),e.listeners=null),n.forEach(E),t?.remove()}function H(e,t,n){if(typeof e=="string"||A(e))return m(e,t,n);if(k(e))return e(t,{children:n});throw new Error(`Invalid component type passed to "h": expected a string, class component, or function component but received ${typeof e} (${e}).`)}function W(e){return K(e)}function vt(e,t=null){let n=null,r=!1,s=null;function o(){n=null,r=!1,s=null}return{mount(i){if(!i){console.warn("createApp.mount(): Element does not exists.");return}if(r)throw new Error("The application is already mounted");n=i,s=H(e,t),h(s,n),r=!0},unmount(){if(!r)throw new Error("The application is not mounted");E(s),o()}}}function St(e,{children:t}){return W(t)}c.Component=T,c.Fragment=St,c.FragmentVNode=j,c.TextVNode=b,c.createApp=vt,c.createFragmentVNode=K,c.createTextVNode=z,c.createVNode=m,c.defineComponent=Ot,c.h=H,c.hFragment=W,c.isClassComponent=A,c.isClassComponentVNode=C,c.isElementVNode=O,c.isFragmentVNode=y,c.isFunctionComponent=k,c.isTextVNode=N,c.isVNode=d,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.min.js.map
